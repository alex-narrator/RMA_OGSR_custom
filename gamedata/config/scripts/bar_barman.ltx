[logic]
active = walker@at_hole
combat_ignore = combat_ignore
trade = misc\trade_barman.ltx
inv_max_weight = 10000
 
[walker@go_to_hole]
path_walk = bar_barman_hole_walk
path_look = bar_barman_hole_look
meet = no_meet
danger = danger_condition@barman
on_actor_not_in_zone = bar_bar_room_area | {+bar_barman_need_hole} walker@at_hole ;%+bar_barman_stay_hole%
 
[walker@at_hole]
path_walk = bar_barman_hole_walk
path_look = bar_barman_hole_look
def_state_standing = barman_wait_free
def_state_moving1 = barman_walk_free
def_state_moving2 = barman_walk_free
def_state_moving3 = barman_walk_free
meet = meet@at_hole
danger = danger_condition@barman
on_signal = at_hole | %+bar_barman_stay_hole%
on_info = {=actor_in_zone(bar_barman_meet_zone_1)} walker@zone_1, {=actor_in_zone(bar_barman_meet_zone_2)} walker@zone_2,{=actor_in_zone(bar_barman_meet_zone_3)} walker@zone_3, walker@at_hole
on_info2 = {+bar_barman_need_room -bar_psih_come} walker@go_to_room, {+bar_barman_need_room +bar_psih_come -bar_psih_done} walker@go_to_room_psih
on_info3 = {+bar_barmen_go_read_doc} walker@go_to_room_read_docs

[walker@zone_1]
path_walk = barman_zone_1_walk
path_look = barman_zone_1_look
def_state_standing = barman_wait_free
def_state_moving1 = barman_walk_free
def_state_moving2 = barman_walk_free
def_state_moving3 = barman_walk_free
meet = meet@at_hole
danger = danger_condition@barman
on_signal = at_hole | %+bar_barman_stay_hole%
on_info = {=actor_in_zone(bar_barman_meet_zone_1)} walker@zone_1, {=actor_in_zone(bar_barman_meet_zone_2)} walker@zone_2,{=actor_in_zone(bar_barman_meet_zone_3)} walker@zone_3, walker@at_hole
on_info2 = {+bar_barman_need_room -bar_psih_come} walker@go_to_room, {+bar_barman_need_room +bar_psih_come -bar_psih_done} walker@go_to_room_psih
on_info3 = {+bar_barmen_go_read_doc} walker@go_to_room_read_docs

[walker@zone_2]
path_walk = barman_zone_2_walk
path_look = barman_zone_2_look
def_state_standing = barman_wait_free
def_state_moving1 = barman_walk_free
def_state_moving2 = barman_walk_free
def_state_moving3 = barman_walk_free
meet = meet@at_hole
danger = danger_condition@barman
on_signal = at_hole | %+bar_barman_stay_hole%
on_info = {=actor_in_zone(bar_barman_meet_zone_1)} walker@zone_1, {=actor_in_zone(bar_barman_meet_zone_2)} walker@zone_2,{=actor_in_zone(bar_barman_meet_zone_3)} walker@zone_3, walker@at_hole
on_info2 = {+bar_barman_need_room -bar_psih_come} walker@go_to_room, {+bar_barman_need_room +bar_psih_come -bar_psih_done} walker@go_to_room_psih
on_info3 = {+bar_barmen_go_read_doc} walker@go_to_room_read_docs

[walker@zone_3]
path_walk = barman_zone_3_walk
path_look = barman_zone_3_look
def_state_standing = barman_wait_free
def_state_moving1 = barman_walk_free
def_state_moving2 = barman_walk_free
def_state_moving3 = barman_walk_free
meet = meet@at_hole
danger = danger_condition@barman
on_signal = at_hole | %+bar_barman_stay_hole%
on_info = {=actor_in_zone(bar_barman_meet_zone_1)} walker@zone_1, {=actor_in_zone(bar_barman_meet_zone_2)} walker@zone_2,{=actor_in_zone(bar_barman_meet_zone_3)} walker@zone_3, walker@at_hole
on_info2 = {+bar_barman_need_room -bar_psih_come} walker@go_to_room, {+bar_barman_need_room +bar_psih_come -bar_psih_done} walker@go_to_room_psih
on_info3 = {+bar_barmen_go_read_doc} walker@go_to_room_read_docs

[walker@go_to_room]
path_walk = bar_barman_room_walk
path_look = bar_barman_room_look
meet = no_meet
danger = danger_condition@barman
;on_timer = 20000 | walker@at_room %+bar_barman_stay_room%
on_signal = at_room | walker@at_room %+bar_barman_stay_room%
on_info = {+bar_barman_need_hole} walker@go_to_hole
on_info2 = {=barman_conditions} walker@at_room2
on_info3 = {+bar_barman_stay_room} walker@at_room

[walker@go_to_room_psih]
path_walk = bar_barman_room_walk_psih
path_look = bar_barman_room_look_psih
meet = no_meet
danger = danger_condition@barman
on_signal = arrived | walker@at_room_psih %+bar_barman_stay_room%
on_info = {+bar_barman_need_hole} walker@go_to_hole
on_info2 = {=barman_conditions} walker@at_room2
on_info3 = {+bar_barman_stay_room} walker@at_room_psih

[walker@at_room_psih]
path_walk = bar_barman_room_walk_psih
path_look = bar_barman_room_look_psih
meet = meet@at_room
danger = danger_condition@barman
on_info = {+bar_barman_need_hole} walker@go_to_hole
;on_info2 = {=barman_conditions} walker@at_room_psih2

[walker@at_room_psih2]
path_walk = bar_barman_room_walk_psih
path_look = bar_barman_room_look_psih
meet = no_meet
danger = danger_condition@barman
on_info = {+bar_barman_need_hole} walker@go_to_hole

[walker@at_room]
path_walk = bar_barman_room_walk
path_look = bar_barman_room_look
meet = meet@at_room
danger = danger_condition@barman
on_info = {+bar_barman_need_hole} walker@go_to_hole
on_info2 = {=barman_conditions} walker@at_room2

[walker@at_room2]
path_walk = bar_barman_room_walk
path_look = bar_barman_room_look
meet = no_meet
danger = danger_condition@barman
on_info = {+bar_barman_need_hole} walker@go_to_hole

;Идёт читать документы
[walker@go_to_room_read_docs]
path_walk = bar_barman_room_walk
path_look = bar_barman_room_look
meet = no_meet
danger = danger_condition@barman
on_info = {-bar_barmen_go_read_doc +bar_barmen_read_x16_doc} walker@at_room, {-bar_barmen_go_read_doc} walker@at_hole


[meet@at_hole]
meet_state = 2|barman_talk_free@bar_bar_barmen_hello
meet_state_wpn = 2|barman_talk_free@bar_bar_barmen_hello
victim = 2|actor
victim_wpn = 2|actor
use = true
use_wpn = true
meet_dialog		=  bar_bar_barmen_start

[meet@at_room]
meet_state = 2|barman_talk_free@bar_bar_barmen_hello_room
meet_state_wpn = 2|barman_talk_free@bar_bar_barmen_hello_room
victim = 2|actor
victim_wpn = 2|actor
use = true
use_wpn = true
meet_dialog		=  bar_bar_barmen_start

[danger_condition@barman]
ignore_distance       = 0

[combat_ignore]
combat_ignore_cond = always